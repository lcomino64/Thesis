% ***************************************************
% Appendix
% ***************************************************
\chapter{Appendix}
\newcommand\x{0.8} % Width of plots
\newcommand\xLarge{1.0} % Width of plots


\newpage
\section{Full Single Core Results}
\begin{figure}[h!t]
    \begin{center}
        \caption{Single Core, Basic Test 1 Server Metrics}
        \label{Fig:A1.1}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/1c_results/arty-a7-1c_basic_1_20241004_110917.db_server_metrics.png}
    \end{center}
\end{figure}

\begin{figure}[h!t]
    \begin{center}
        \caption{Single Core, Basic Test 2 Server and Client Metrics}
        \label{Fig:A1.2}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/1c_results/arty-a7-1c_basic_2_20241004_111711.db_server_metrics.png}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/1c_results/arty-a7-1c_basic_2_20241004_111711.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Single Core, Basic Test 3 Server and Client Metrics}
        \label{Fig:A1.3}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/1c_results/arty-a7-1c_basic_3_20241004_112455.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/1c_results/arty-a7-1c_basic_3_20241004_112455.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Single Core, Large Scale, 100 clients, Server and Client Metrics}
        \label{Fig:A1.4}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/1c_results/arty-a7-1c_large_scale_1000_20241004_114004.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/1c_results/arty-a7-1c_large_scale_1000_20241004_114004.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\section{Full Dual Core Results}

\begin{figure}[h!t]
    \begin{center}
        \caption{Dual Core, Basic Test 1 Server Metrics}
        \label{Fig:A1.5}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/2c_results/arty-a7-2c_basic_1_20241003_151153.db_server_metrics.png}
    \end{center}
\end{figure}

\begin{figure}[h!t]
    \begin{center}
        \caption{Dual Core, Basic Test 2 Server and Client Metrics}
        \label{Fig:A1.6}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/2c_results/arty-a7-2c_basic_2_20241003_151819.db_server_metrics.png}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/2c_results/arty-a7-2c_basic_2_20241003_151819.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Dual Core, Basic Test 3 Server and Client Metrics}
        \label{Fig:A1.7}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_results/arty-a7-2c_basic_3_20241003_152340.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_results/arty-a7-2c_basic_3_20241003_152340.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Dual Core, Large Scale, 100 clients, Server and Client Metrics}
        \label{Fig:A1.8}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_results/arty-a7-2c_large_scale_1000_20241003_153405.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_results/arty-a7-2c_large_scale_1000_20241003_153405.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\section{Full Quad Core Results}

\begin{figure}[h!t]
    \begin{center}
        \caption{Quad Core, Basic Test 1 Server Metrics}
        \label{Fig:A1.9}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/4c_results/arty-a7-4c_basic_1_20241002_164824.db_server_metrics.png}
    \end{center}
\end{figure}

\begin{figure}[h!t]
    \begin{center}
        \caption{Quad Core, Basic Test 2 Server and Client Metrics}
        \label{Fig:A1.10}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/4c_results/arty-a7-4c_basic_2_20241003_132631.db_server_metrics.png}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/4c_results/arty-a7-4c_basic_2_20241003_132631.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Quad Core, Basic Test 3 Server and Client Metrics}
        \label{Fig:A1.11}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/4c_results/arty-a7-4c_basic_3_20241003_133647.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/4c_results/arty-a7-4c_basic_3_20241003_133647.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Quad Core, Large Scale, 100 clients, Server and Client Metrics}
        \label{Fig:A1.12}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/4c_results/arty-a7-4c_large_scale_1000_20241003_140220.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/4c_results/arty-a7-4c_large_scale_1000_20241003_140220.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\section{Full Raspberry Pi Results}
\begin{figure}[h!t]
    \begin{center}
        \caption{Raspberry Pi, Basic Test 1 Server Metrics}
        \label{Fig:A1.13}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/raspberry-pi_results/raspberry-pi_basic_1_20241004_140120.db_server_metrics.png}
    \end{center}
\end{figure}

\begin{figure}[h!t]
    \begin{center}
        \caption{Raspberry Pi, Basic Test 2 Server and Client Metrics}
        \label{Fig:A1.14}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/raspberry-pi_results/raspberry-pi_basic_2_20241004_140133.db_server_metrics.png}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/raspberry-pi_results/raspberry-pi_basic_2_20241004_140133.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Raspberry Pi, Basic Test 3 Server and Client Metrics}
        \label{Fig:A1.15}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/raspberry-pi_results/raspberry-pi_basic_3_20241004_140137.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/raspberry-pi_results/raspberry-pi_basic_3_20241004_140137.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Raspberry Pi, Large Scale, 100 clients, Server and Client Metrics}
        \label{Fig:A1.16}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/raspberry-pi_results/raspberry-pi_large_scale_1000_20241004_140150.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/raspberry-pi_results/raspberry-pi_large_scale_1000_20241004_140150.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\section{Full Improved Dual Core Results}
\begin{figure}[h!t]
    \begin{center}
        \caption{Improved Dual Core, Basic Test 1 Server Metrics}
        \label{Fig:A1.17}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/2c_improved_results/arty-a7-2c-improved_basic_1_20241007_121858.db_server_metrics.png}
    \end{center}
\end{figure}

\begin{figure}[h!t]
    \begin{center}
        \caption{Improved Dual Core, Basic Test 2 Server and Client Metrics}
        \label{Fig:A1.18}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/2c_improved_results/arty-a7-2c-improved_basic_2_20241007_122337.db_server_metrics.png}
    \includegraphics[width=\x\textwidth]{Chapter4/Results/2c_improved_results/arty-a7-2c-improved_basic_2_20241007_122337.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Improved Dual Core, Basic Test 3 Server and Client Metrics}
        \label{Fig:A1.19}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_improved_results/arty-a7-2c-improved_basic_3_20241007_122706.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_improved_results/arty-a7-2c-improved_basic_3_20241007_122706.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\begin{figure}[h!t]
    \begin{center}
        \caption{Improved Dual Core, Large Scale, 100 clients, Server and Client Metrics}
        \label{Fig:A1.20}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_improved_results/arty-a7-2c-improved_large_scale_1000_20241007_123418.db_server_metrics.png}
    \includegraphics[width=\xLarge\textwidth]{Chapter4/Results/2c_improved_results/arty-a7-2c-improved_large_scale_1000_20241007_123418.db_client_tasks.png}
    \end{center}
\end{figure}

\newpage
\section{LiteX BIOS Console Help Menu}
\label{Fig:A1.22}
\begin{lstlisting}{Full Litex BIOS Output from Loading a Zephyr Binary}
    --============= Console ================--

    litex> help
    
    LiteX BIOS, available commands:
    
    leds                     - Set Leds value
    flush_l2_cache           - Flush L2 cache
    flush_cpu_dcache         - Flush CPU data cache
    crc                      - Compute CRC32 of a part of the address space
    uptime                   - Uptime of the system since power-up
    ident                    - Identifier of the system
    help                     - Print this help
    
    netboot                  - Boot via Ethernet (TFTP)
    serialboot               - Boot from Serial (SFL)
    reboot                   - Reboot
    boot                     - Boot from Memory
    
    mem_cmp                  - Compare memory content
    mem_speed                - Test memory speed
    mem_test                 - Test memory access
    mem_copy                 - Copy address space
    mem_write                - Write address space
    mem_read                 - Read address space
    mem_list                 - List available memory regions
    
    flash_erase_range        - Erase flash range
    flash_from_sdcard        - Write file from SD card to flash
    flash_write              - Write to flash
    
    i2c_dev                  - List/Set I2C controller(s)
    i2c_scan                 - Scan for I2C slaves
    i2c_read                 - Read over I2C
    i2c_write                - Write over I2C
    i2c_reset                - Reset I2C line state
    
    sdram_spd                - Read SDRAM SPD EEPROM
    sdram_mr_write           - Write SDRAM Mode Register
    sdram_cal                - Calibrate SDRAM
    sdram_test               - Test SDRAM
    sdram_init               - Initialize SDRAM (Init + Calibration)
    sdram_force_wrphase      - Force write phase
    sdram_force_rdphase      - Force read phase
    
    mdio_dump                - Dump MDIO registers
    mdio_read                - Read MDIO register
    mdio_write               - Write MDIO register
\end{lstlisting}
\label{Fig:A1.21}

\newpage
\section{Full Output From Loading a Zephyr Binary}
\begin{lstlisting}{Full Litex BIOS Output from Loading a Zephyr Binary}
lachlancomino@ubuntu-machine:~/zephyrproject/zephyr$ litex_term /dev/ttyUSB2
 --speed 115200 --kernel build/zephyr/zephyr.bin
     / /  (_) /____ | |/_/
      / /__/ / __/ -_)>  <
     /____/_/\__/\__/_/|_|
   Build your hardware, easily!

 (c) Copyright 2012-2024 Enjoy-Digital
 (c) Copyright 2007-2015 M-Labs

 BIOS CRC passed (02a8afa1)

 LiteX git sha1: ef775e0b8

--=============== SoC ==================--
CPU:		VexRiscv SMP-STANDARD @ 100MHz
BUS:		wishbone 32-bit @ 4GiB
CSR:		32-bit data
ROM:		64.0KiB
SRAM:		16.0KiB
L2:		8.0KiB
SDRAM:		64.0MiB 16-bit @ 800MT/s (CL-7 CWL-5)
MAIN-RAM:	256.0MiB

--========== Initialization ============--
Initializing SDRAM @0x40000000...
Switching SDRAM to software control.
Read leveling:
  m0, b00: |00000000000000000000000000000000| delays: -
  m0, b01: |00000000000000000000000000000000| delays: -
  m0, b02: |11111111111000000000000000000000| delays: 05+-05
  m0, b03: |00000000000001111111111111100000| delays: 19+-06
  m0, b04: |00000000000000000000000000000011| delays: 30+-00
  m0, b05: |00000000000000000000000000000000| delays: -
  m0, b06: |00000000000000000000000000000000| delays: -
  m0, b07: |00000000000000000000000000000000| delays: -
  best: m0, b03 delays: 19+-06
  m1, b00: |00000000000000000000000000000000| delays: -
  m1, b01: |00000000000000000000000000000000| delays: -
  m1, b02: |11111111111000000000000000000000| delays: 05+-05
  m1, b03: |00000000000001111111111111100000| delays: 20+-06
  m1, b04: |00000000000000000000000000000011| delays: 30+-00
  m1, b05: |00000000000000000000000000000000| delays: -
  m1, b06: |00000000000000000000000000000000| delays: -
  m1, b07: |00000000000000000000000000000000| delays: -
  best: m1, b03 delays: 19+-06
Switching SDRAM to hardware control.
Memtest at 0x40000000 (2.0MiB)...
  Write: 0x40000000-0x40200000 2.0MiB     
   Read: 0x40000000-0x40200000 2.0MiB     
Memtest OK
Memspeed at 0x40000000 (Sequential, 2.0MiB)...
  Write speed: 161.0MiB/s
   Read speed: 77.9MiB/s

--============== Boot ==================--
Booting from serial...
Press Q or ESC to abort boot completely.
sL5DdSMmkekro
[LITEX-TERM] Received firmware download request from the device.
[LITEX-TERM] Uploading build/zephyr/zephyr.bin to 0x40000000 (33982 bytes)...
[LITEX-TERM] Upload calibration... (inter-frame: 10.00us, length: 64)
[LITEX-TERM] Upload complete (9.9KB/s).
[LITEX-TERM] Booting the device.
[LITEX-TERM] Done.
Executing booted program at 0x40000000

--============= Liftoff! ===============--
\end{lstlisting}


\newpage
\section{Full Output from Loading Buildroot Linux}
\label{Fig:A1.23}
\begin{lstlisting}{Full Output from Loading Buildroot Linux}
Terminal ready
    Build your hardware, easily!

    (c) Copyright 2012-2024 Enjoy-Digital
    (c) Copyright 2007-2015 M-Labs

    BIOS CRC passed (1df78940)

    LiteX git sha1: a350d2e90

--=============== SoC ==================--
CPU:		VexRiscv SMP-LINUX @ 150MHz
BUS:		wishbone 32-bit @ 4GiB
CSR:		32-bit data
ROM:		64.0KiB
SRAM:		16.0KiB
L2:		8.0KiB
FLASH:		16.0MiB
SDRAM:		64.0MiB 16-bit @ 1200MT/s (CL-11 CWL-7)
MAIN-RAM:	256.0MiB

--========== Initialization ============--
Ethernet init...

Initializing SDRAM @0x40000000...
Switching SDRAM to software control.
Read leveling:
    m0, b00: |00000000000000000000000000000000| delays: -
    m0, b01: |00000000000000000000000000000000| delays: -
    m0, b02: |00000000000000000000000000000000| delays: -
    m0, b03: |11111110000000000000000000000000| delays: 02+-02
    m0, b04: |00000000011111111000000000000000| delays: 12+-04
    m0, b05: |00000000000000000001111111100000| delays: 22+-03
    m0, b06: |00000000000000000000000000000001| delays: -
    m0, b07: |00000000000000000000000000000000| delays: -
    best: m0, b04 delays: 12+-04
    m1, b00: |00000000000000000000000000000000| delays: -
    m1, b01: |00000000000000000000000000000000| delays: -
    m1, b02: |00000000000000000000000000000000| delays: -
    m1, b03: |11111100000000000000000000000000| delays: 02+-02
    m1, b04: |00000000011111111000000000000000| delays: 12+-04
    m1, b05: |00000000000000000001111111110000| delays: 23+-03
    m1, b06: |00000000000000000000000000000001| delays: 30+-00
    m1, b07: |00000000000000000000000000000000| delays: -
    best: m1, b05 delays: 23+-04
Switching SDRAM to hardware control.
Memtest at 0x40000000 (2.0MiB)...
    Write: 0x40000000-0x40200000 2.0MiB     
    Read: 0x40000000-0x40200000 2.0MiB     
Memtest OK
Memspeed at 0x40000000 (Sequential, 2.0MiB)...
    Write speed: 242.4MiB/s
    Read speed: 116.8MiB/s

Initializing s25fl128l SPI Flash @0x01000000...
Enabling Quad mode...
SPI Flash clk configured to 18 MHz
Memspeed at 0x1000000 (Sequential, 4.0KiB)...
    Read speed: 30.9MiB/s
Memspeed at 0x1000000 (Random, 4.0KiB)...
    Read speed: 5.8MiB/s

--============== Boot ==================--
Booting from serial...
Press Q or ESC to abort boot completely.
sL5DdSMmkekro
Timeout
Booting from network...
Local IP: 192.168.1.50
Remote IP: 192.168.1.100
Booting from boot.json...
Copying Image to 0x40000000... (8510016 bytes)
Copying rv32.dtb to 0x40ef0000... (5694 bytes)
Copying rootfs.cpio to 0x41000000... (33890816 bytes)
Copying opensbi.bin to 0x40f00000... (263652 bytes)
Executing booted program at 0x40f00000

--============= Liftoff! ===============--

OpenSBI v1.3
    ____                    _____ ____ _____
    / __ \                  / ____|  _ \_   _|
    | |  | |_ __   ___ _ __ | (___ | |_) || |
    | |  | | '_ \ / _ \ '_ \ \___ \|  _ < | |
    | |__| | |_) |  __/ | | |____) | |_) || |_
    \____/| .__/ \___|_| |_|_____/|____/_____|
        | |
        |_|
Platform Name             : LiteX / VexRiscv-SMP
Platform Features         : medeleg
Platform HART Count       : 8
Platform IPI Device       : aclint-mswi
Platform Timer Device     : aclint-mtimer @ 100000000Hz
Platform Console Device   : litex_uart
Platform HSM Device       : ---
Platform PMU Device       : ---
Platform Reboot Device    : ---
Platform Shutdown Device  : ---
Platform Suspend Device   : ---
Platform CPPC Device      : ---
Firmware Base             : 0x40f00000
Firmware Size             : 376 KB
Firmware RW Offset        : 0x40000
Firmware RW Size          : 120 KB
Firmware Heap Offset      : 0x52000
Firmware Heap Size        : 48 KB (total), 3 KB (reserved), 8 KB (used), 36 KB (free)
Firmware Scratch Size     : 4096 B (total), 452 B (used), 3644 B (free)
Runtime SBI Version       : 1.0

Domain0 Name              : root
Domain0 Boot HART         : 0
Domain0 HARTs             : 0*,1*,2*,3*,4*,5*,6*,7*
Domain0 Region00          : 0xf0018000-0xf001bfff M: (I,R,W) S/U: ()
Domain0 Region01          : 0xf0010000-0xf0017fff M: (I,R,W) S/U: ()
Domain0 Region02          : 0x40f40000-0x40f5ffff M: (R,W) S/U: ()
Domain0 Region03          : 0x40f00000-0x40f3ffff M: (R,X) S/U: ()
Domain0 Region04          : 0x00000000-0xffffffff M: (R,W,X) S/U: (R,W,X)
Domain0 Next Address      : 0x40000000
Domain0 Next Arg1         : 0x40ef0000
Domain0 Next Mode         : S-mode
Domain0 SysReset          : yes
Domain0 SysSuspend        : yes

Boot HART ID              : 0
Boot HART Domain          : root
Boot HART Priv Version    : unknown
Boot HART Base ISA        : rv32ima
Boot HART ISA Extensions  : zicntr
Boot HART PMP Count       : 0
Boot HART PMP Granularity : 0
Boot HART PMP Address Bits: 0
Boot HART MHPM Count      : 0
Boot HART MIDELEG         : 0x00000222
Boot HART MEDELEG         : 0x0000b109
[    0.000000] Linux version 6.9.0 (lachlancomino@ubuntu-machine) (riscv32-buildroot-linux-gnu-gcc.br_real (Buildroot 2023.02.11-dirty) 11.4.0, GNU ld (GNU Binutils) 2.38) #1 SMP Thu Oct  3 09:48:44 AEST 2024
[    0.000000] Machine model: digilent_arty
[    0.000000] SBI specification v1.0 detected
[    0.000000] SBI implementation ID=0x1 Version=0x10003
[    0.000000] SBI TIME extension detected
[    0.000000] SBI IPI extension detected
[    0.000000] SBI RFENCE extension detected
[    0.000000] earlycon: liteuart0 at I/O port 0x0 (options '')
[    0.000000] Malformed early option 'console'
[    0.000000] earlycon: liteuart0 at MMIO 0xf0001000 (options '')
[    0.000000] printk: legacy bootconsole [liteuart0] enabled
[    0.000000] OF: reserved mem: OVERLAP DETECTED!
[    0.000000] mmode_resv1@40f00000 (0x40f00000--0x40f40000) overlaps with opensbi@40f00000 (0x40f00000--0x40f80000)
[    0.000000] OF: reserved mem: OVERLAP DETECTED!
[    0.000000] opensbi@40f00000 (0x40f00000--0x40f80000) overlaps with mmode_resv0@40f40000 (0x40f40000--0x40f60000)
[    0.000000] OF: reserved mem: 0x40f00000..0x40f3ffff (256 KiB) nomap non-reusable mmode_resv1@40f00000
[    0.000000] OF: reserved mem: 0x40f00000..0x40f7ffff (512 KiB) map non-reusable opensbi@40f00000
[    0.000000] OF: reserved mem: 0x40f40000..0x40f5ffff (128 KiB) nomap non-reusable mmode_resv0@40f40000
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x0000000040000000-0x000000004fffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x0000000040000000-0x0000000040efffff]
[    0.000000]   node   0: [mem 0x0000000040f00000-0x0000000040f5ffff]
[    0.000000]   node   0: [mem 0x0000000040f60000-0x000000004fffffff]
[    0.000000] Initmem setup node 0 [mem 0x0000000040000000-0x000000004fffffff]
[    0.000000] SBI HSM extension detected
[    0.000000] riscv: base ISA extensions aim
[    0.000000] riscv: ELF capabilities aim
[    0.000000] percpu: Embedded 11 pages/cpu s22932 r0 d22124 u45056
[    0.000000] Kernel command line: console=liteuart earlycon=liteuart,0xf0001000 rootwait root=/dev/ram0 ip=192.168.1.50:192.168.1.100:192.168.1.100:255.255.255.0::eth0:off:::
[    0.000000] Unknown kernel command line parameters "ip=192.168.1.50:192.168.1.100:192.168.1.100:255.255.255.0::eth0:off:::", will be passed to user space.
[    0.000000] Dentry cache hash table entries: 32768 (order: 5, 131072 bytes, linear)
[    0.000000] Inode-cache hash table entries: 16384 (order: 4, 65536 bytes, linear)
[    0.000000] Built 1 zonelists, mobility grouping on.  Total pages: 65024
[    0.000000] mem auto-init: stack:off, heap alloc:off, heap free:off
[    0.000000] Memory: 189016K/262144K available (6436K kernel code, 585K rwdata, 1042K rodata, 242K init, 249K bss, 73128K reserved, 0K cma-reserved)
[    0.000000] SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=2, Nodes=1
[    0.000000] rcu: Hierarchical RCU implementation.
[    0.000000] rcu: 	RCU restricting CPUs from NR_CPUS=32 to nr_cpu_ids=2.
[    0.000000] rcu: RCU calculated value of scheduler-enlistment delay is 10 jiffies.
[    0.000000] rcu: Adjusting geometry for rcu_fanout_leaf=16, nr_cpu_ids=2
[    0.000000] NR_IRQS: 64, nr_irqs: 64, preallocated irqs: 0
[    0.000000] riscv-intc: 32 local interrupts mapped
[    0.000000] riscv: providing IPIs using SBI IPI extension
[    0.000000] rcu: srcu_init: Setting srcu_struct sizes based on contention.
[    0.000000] clocksource: riscv_clocksource: mask: 0xffffffffffffffff max_cycles: 0x2298375bd0, max_idle_ns: 440795208267 ns
[    0.000020] sched_clock: 64 bits at 150MHz, resolution 6ns, wraps every 2199023255551ns
[    0.009873] Console: colour dummy device 80x25
[    0.013539] Calibrating delay loop (skipped), value calculated using timer frequency.. 300.00 BogoMIPS (lpj=1500000)
[    0.023955] pid_max: default: 32768 minimum: 301
[    0.031163] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes, linear)
[    0.037671] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes, linear)
[    0.076981] ASID allocator using 9 bits (512 entries)
[    0.084125] rcu: Hierarchical SRCU implementation.
[    0.087718] rcu: 	Max phase no-delay instances is 1000.
[    0.106195] smp: Bringing up secondary CPUs ...
[    0.124908] smp: Brought up 1 node, 2 CPUs
[    0.141635] devtmpfs: initialized
[    0.202433] clocksource: jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 19112604462750000 ns
[    0.211624] futex hash table entries: 512 (order: 3, 32768 bytes, linear)
[    0.240583] NET: Registered PF_NETLINK/PF_ROUTE protocol family
[    0.254564] DMA: preallocated 128 KiB GFP_KERNEL pool for atomic allocations
[    0.342616] cpu1: Ratio of byte access time to unaligned word access is 0.00, unaligned accesses are slow
[    0.434825] cpu0: Ratio of byte access time to unaligned word access is 0.00, unaligned accesses are slow
[    0.467036] platform soc: Fixed dependency cycle(s) with /soc/interrupt-controller@f0c00000
[    0.482167] platform soc: Fixed dependency cycle(s) with /soc/interrupt-controller@f0c00000
[    0.558727] pps_core: LinuxPPS API ver. 1 registered
[    0.562838] pps_core: Software ver. 5.3.6 - Copyright 2005-2007 Rodolfo Giometti <giometti@linux.it>
[    0.571950] PTP clock support registered
[    0.579705] FPGA manager framework
[    0.597305] clocksource: Switched to clocksource riscv_clocksource
[    0.870387] NET: Registered PF_INET protocol family
[    0.877651] IP idents hash table entries: 4096 (order: 3, 32768 bytes, linear)
[    0.894058] tcp_listen_portaddr_hash hash table entries: 512 (order: 0, 4096 bytes, linear)
[    0.901887] Table-perturb hash table entries: 65536 (order: 6, 262144 bytes, linear)
[    0.909449] TCP established hash table entries: 2048 (order: 1, 8192 bytes, linear)
[    0.917333] TCP bind hash table entries: 2048 (order: 3, 32768 bytes, linear)
[    0.924211] TCP: Hash tables configured (established 2048 bind 2048)
[    0.931350] UDP hash table entries: 256 (order: 1, 8192 bytes, linear)
[    0.936966] UDP-Lite hash table entries: 256 (order: 1, 8192 bytes, linear)
[    0.951892] Unpacking initramfs...
[    0.988011] workingset: timestamp_bits=30 max_order=16 bucket_order=0
[    1.000823] io scheduler mq-deadline registered
[    1.004239] io scheduler kyber registered
[    1.008804] io scheduler bfq registered
[    1.021730] riscv-plic f0c00000.interrupt-controller: mapped 32 interrupts with 2 handlers for 4 contexts.
[    1.080250] No litex,nclkout entry in the dts file
[    1.088375] LiteX SoC Controller driver initialized
[    2.834492] f0001000.serial: ttyLXU0 at MMIO 0x0 (irq = 13, base_baud = 0) is a liteuart
[    2.846821] printk: legacy console [liteuart0] enabled
[    2.846821] printk: legacy console [liteuart0] enabled
[    2.856681] printk: legacy bootconsole [liteuart0] disabled
[    2.856681] printk: legacy bootconsole [liteuart0] disabled
[    2.927478] liteeth f0002000.mac eth0: irq 14 slots: tx 16 rx 16 size 2048
[    2.937988] i2c_dev: i2c /dev entries driver
[    2.950607] i2c i2c-0: Not I2C compliant: can't read SCL
[    2.954845] i2c i2c-0: Bus may be unreliable
[    2.996491] NET: Registered PF_INET6 protocol family
[    3.022407] Segment Routing with IPv6
[    3.026358] In-situ OAM (IOAM) with IPv6
[    3.030942] sit: IPv6, IPv4 and MPLS over IPv4 tunneling driver
[    3.050433] NET: Registered PF_PACKET protocol family
[    3.429578] clk: Disabling unused clocks
[    4.427007] Initramfs unpacking failed: invalid magic at start of compressed archive
[    5.128203] Freeing initrd memory: 61440K
[    5.141095] Freeing unused kernel image (initmem) memory: 236K
[    5.145784] Kernel memory protection not selected by kernel config.
[    5.152867] Run /init as init process
Saving 256 bits of non-creditable seed for next boot
Starting syslogd: OK
Starting klogd: OK
Running sysctl: OK
Starting haveged: haveged: haveged: can not open UNIX socket
haveged: can not initialize command socket: Address family not supported by protocol
haveged: disabling command mode for this instance
haveged: haveged starting up
OK
Starting network: OK

Welcome to Buildroot
buildroot login: root
                    __   _
                    / /  (_)__  __ ____ __
                    / /__/ / _ \/ // /\ \ /
                /____/_/_//_/\_,_//_\_\
                        / _ \/ _ \
    __   _ __      _  _\___/_//_/         ___  _
    / /  (_) /____ | |/_/__| | / /____ __ / _ \(_)__ _____  __
    / /__/ / __/ -_)>  </___/ |/ / -_) \ // , _/ (_-</ __/ |/ /
/____/_/\__/\__/_/|_|____|___/\__/_\_\/_/|_/_/___/\__/|___/
                    / __/  |/  / _ \
                    _\ \/ /|_/ / ___/
                /___/_/  /_/_/
    32-bit RISC-V Linux running on LiteX / VexRiscv-SMP.

login[86]: root login on 'console'
root@buildroot:~#
\end{lstlisting}

\newpage
\section{RISC-V Custom Instructions Encoding}
\begin{figure}[h!t]
    \caption{RISC-V Custom Instructions Encoding}
    \label{Fig:A1.24}
    \begin{verbatim}
// In riscv.h, the instruction is defined via:

#define opcode_R(opcode, func3, func7, rs1, rs2)   \
({                                             \
    register unsigned long __v;                \
    asm volatile(                              \
        ".word ((" #opcode ") | (regnum_%0 << 7)  \ 
    | (regnum_%1 << 15) | (regnum_%2 << 20)    \ 
    | ((" #func3 ") << 12) | ((" #func7 ") << 25));"   \
        : [rd] "=r" (__v)                          \
        : "r" (rs1), "r" (rs2)        \
    );                                         \
    __v;                                       \
})

// Then the aes_custom.h envokes this instruction via the C MACROS:

#define aes_enc_round(rs1, rs2, sel) 
    opcode_R(CUSTOM0, 0x00, (sel << 3), rs1, rs2)
#define aes_enc_round_last(rs1, rs2, sel) 
    opcode_R(CUSTOM0, 0x00, (sel << 3) | 2, rs1, rs2)

#define aes_dec_round(rs1, rs2, sel) 
    opcode_R(CUSTOM0, 0x00, (sel << 3) | 1, rs1, rs2)
#define aes_dec_round_last(rs1, rs2, sel) 
    opcode_R(CUSTOM0, 0x00, (sel << 3) | 2 | 1, rs1, rs2)

// And this interface allows for OpenSSL to use the custom AES instructions
    \end{verbatim}
\end{figure}



